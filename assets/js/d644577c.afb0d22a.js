"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[383],{1371:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>t,contentTitle:()=>a,default:()=>p,frontMatter:()=>i,metadata:()=>c,toc:()=>d});var r=s(4848),l=s(8453);const i={sidebar_position:2},a="\u5f00\u53d1",c={id:"b-next/dev-build",title:"\u5f00\u53d1",description:"\u4f60\u5c06\u8981\u5b66\u4e60\u5982\u4f55\u5f00\u53d1\u4e00\u4e2anpm\u5e94\u7528",source:"@site/docs/b-next/2-dev-build.md",sourceDirName:"b-next",slug:"/b-next/dev-build",permalink:"/docs/docs/b-next/dev-build",draft:!1,unlisted:!1,editUrl:"https://github.com/yunzai-org/docs/tree/main/docs/b-next/2-dev-build.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"\u5b89\u88c5",permalink:"/docs/docs/b-next/translate-your-site"},next:{title:"\u5468\u671f",permalink:"/docs/docs/b-next/life-cycle"}},t={},d=[{value:"\u5b89\u88c5\u6a21\u677f",id:"\u5b89\u88c5\u6a21\u677f",level:2},{value:"\u91cd\u65b0\u5f00\u59cb",id:"\u91cd\u65b0\u5f00\u59cb",level:2},{value:"\u8fd0\u884c",id:"\u8fd0\u884c",level:3},{value:"\u6d88\u606f",id:"\u6d88\u606f",level:3},{value:"\u70ed\u5f00\u53d1",id:"\u70ed\u5f00\u53d1",level:3},{value:"\u6253\u5305",id:"\u6253\u5305",level:3},{value:"\u53d1\u5e03",id:"\u53d1\u5e03",level:3},{value:"\u6e90\u7801",id:"\u6e90\u7801",level:3}];function o(n){const e={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.h1,{id:"\u5f00\u53d1",children:"\u5f00\u53d1"}),"\n",(0,r.jsx)(e.admonition,{title:"\u63d0\u793a",type:"tip",children:(0,r.jsx)(e.p,{children:"\u4f60\u5c06\u8981\u5b66\u4e60\u5982\u4f55\u5f00\u53d1\u4e00\u4e2anpm\u5e94\u7528"})}),"\n",(0,r.jsx)(e.h2,{id:"\u5b89\u88c5\u6a21\u677f",children:"\u5b89\u88c5\u6a21\u677f"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"npm create yunzai@latest -y\ncd yunzai\nnpm install yarn@1.19.1 -y\nyarn\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\u91cd\u65b0\u5f00\u59cb",children:"\u91cd\u65b0\u5f00\u59cb"}),"\n",(0,r.jsx)(e.h3,{id:"\u8fd0\u884c",children:"\u8fd0\u884c"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u521d\u59cb\u5316package"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"npm init -y\n"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u5b89\u88c5\u5f00\u53d1\u6846\u67b6"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"npm install yarn@1.19.1 -y\nyarn add react puppeteer react-puppeteer -W\nyarn add yunzai  -D\n"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u5b89\u88c5ts\u73af\u5883"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"yarn add ts-node -D\nyarn add typescript -D\n"})}),"\n",(0,r.jsxs)(e.blockquote,{children:["\n",(0,r.jsx)(e.p,{children:"tsconfig.json"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{\n  "include": ["src"],\n  "extends": "yunzai/tsconfig/tsconfig.json"\n}\n'})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u521b\u5efa\u57fa\u7840\u6587\u4ef6"}),"\n"]}),"\n",(0,r.jsxs)(e.blockquote,{children:["\n",(0,r.jsx)(e.p,{children:"src/global.env.d.ts"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:'/// <reference types="yunzai/global" />\n'})}),"\n",(0,r.jsxs)(e.blockquote,{children:["\n",(0,r.jsx)(e.p,{children:"src/react-puppeteer.env.d.ts"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:'/// <reference types="react-puppeteer/env" />\n'})}),"\n",(0,r.jsxs)(e.blockquote,{children:["\n",(0,r.jsx)(e.p,{children:"src/index.ts"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"import { applicationOptions, useAppStorage } from 'yunzai'\nconst Data = useAppStorage()\nexport default () => {\n  return applicationOptions({\n    // \u63d2\u4ef6\u521b\u5efa\u65f6\n    create() {},\n    // \u88ab\u6267\u884c\u65f6\n    mounted() {\n      return Data\n    }\n  })\n}\n"})}),"\n",(0,r.jsxs)(e.blockquote,{children:["\n",(0,r.jsx)(e.p,{children:"yunzai.config.js"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-js",children:"import { defineConfig } from 'yunzai'\nimport Example from './src/index.js'\nexport default defineConfig({\n  applications: [Example()]\n})\n"})}),"\n",(0,r.jsxs)(e.blockquote,{children:["\n",(0,r.jsx)(e.p,{children:"src/main.js"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-js",children:"import { Client, Loader, createLogin, Processor } from 'yunzai'\nsetTimeout(async () => {\n  // \u8f93\u5165login\u914d\u7f6e\n  await createLogin()\n  // \u8fd0\u884c\u5ba2\u6237\u7aef\n  await Client.run().then(async () => {\n    // \u8bfb\u53d6yunzai.config.js\n    await Processor.install()\n  })\n}, 0)\n"})}),"\n",(0,r.jsxs)(e.blockquote,{children:["\n",(0,r.jsx)(e.p,{children:"package.json"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{\n  "type": "module",\n  "scripts": {\n    "app": "node --no-warnings=ExperimentalWarning --loader ts-node/esm src/main.js"\n  }\n}\n'})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"yarn app\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u6d88\u606f",children:"\u6d88\u606f"}),"\n",(0,r.jsxs)(e.blockquote,{children:["\n",(0,r.jsx)(e.p,{children:"src/apps.ts"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"import { Messages } from 'yunzai'\nconst message = new Messages('message.group')\nmessage.use(\n  e => {\n    e.reply('\u4f60\u597d')\n  },\n  [/^(#|\\/)?\u4f60\u597d/]\n)\nexport const Test = message.ok\n"})}),"\n",(0,r.jsxs)(e.blockquote,{children:["\n",(0,r.jsx)(e.p,{children:"src/index.ts"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"import { applicationOptions } from 'yunzai'\nimport * as Apps from './apps.js'\nconst Data = []\nexport default () => {\n  return applicationOptions({\n    // \u63d2\u4ef6\u521b\u5efa\u65f6\n    create() {\n      for (const key in Apps) {\n        Data.push(new Apps[key]())\n      }\n    },\n    // \u88ab\u6267\u884c\u65f6\n    mounted() {\n      // useEvent\n\n      return Data\n    }\n  })\n}\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u70ed\u5f00\u53d1",children:"\u70ed\u5f00\u53d1"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"yarn add nodemon -W\n"})}),"\n",(0,r.jsxs)(e.blockquote,{children:["\n",(0,r.jsx)(e.p,{children:"package.json"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{\n  "scripts": {\n    "app": "node --no-warnings=ExperimentalWarning --loader ts-node/esm src/main.js",\n    "dev": "nodemon"\n  }\n}\n'})}),"\n",(0,r.jsxs)(e.blockquote,{children:["\n",(0,r.jsx)(e.p,{children:"nodemon.json"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{\n  "exec": "npm run app",\n  "verbose": true,\n  "delay": 1000,\n  "restartable": "rs",\n  "watch": ["src"],\n  "env": {\n    "NODE_ENV": "development"\n  },\n  "ext": "js,ts,tsx,jsx"\n}\n'})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"yarn dev\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u6253\u5305",children:"\u6253\u5305"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u5b89\u88c5\u6253\u5305\u73af\u5883"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"yarn add rollup -D\nyarn add @rollup/plugin-terser -D\nyarn add @rollup/plugin-typescript -D\n"})}),"\n",(0,r.jsxs)(e.blockquote,{children:["\n",(0,r.jsx)(e.p,{children:"rollup.config.js"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-js",children:"import typescript from '@rollup/plugin-typescript'\nimport terser from '@rollup/plugin-terser'\n/**\n * @type {import(\"rollup\").RollupOptions[]}\n */\nexport default [\n  {\n    // src \u76ee\u5f55\n    input: './src/index.ts',\n    output: {\n      // lib \u76ee\u5f55\n      dir: 'lib',\n      format: 'es',\n      sourcemap: false,\n      // \u4fdd\u6301\u7ed3\u6784\n      preserveModules: true\n    },\n    plugins: [\n      typescript({\n        compilerOptions: {\n          declaration: true,\n          declarationDir: 'lib'\n        }\n      }),\n      // \u5f00\u542f\u4ee3\u7801\u538b\u7f29\n      terser()\n    ],\n    onwarn: (warning, warn) => {\n      // \u5ffd\u7565\u4e0e\u65e0\u6cd5\u89e3\u6790the\u5bfc\u5165\u76f8\u5173the\u8b66\u544a\u4fe1\u606f\n      if (warning.code === 'UNRESOLVED_IMPORT') return\n      // \u7ee7\u7eed\u4f7f\u7528\u9ed8\u8ba4the\u8b66\u544a\u5904\u7406\n      warn(warning)\n    }\n  }\n]\n"})}),"\n",(0,r.jsxs)(e.blockquote,{children:["\n",(0,r.jsx)(e.p,{children:"package.json"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{\n  "scripts": {\n    "build": "rollup --config rollup.config.js"\n  }\n}\n'})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"yarn build\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u53d1\u5e03",children:"\u53d1\u5e03"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u767b\u5f55"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sh",children:"npm login\n"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"package.json"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{\n  // \u8981\u4e0a\u4f20\u7684\u6587\u4ef6\u5939\n  "files": ["public", "assets", "lib"],\n  // \u7c7b\u578b\u6587\u4ef6\u5939\n  "types": "lib",\n  "exports": {\n    // \u9ed8\u8ba4\u5bfc\u51fa\n    ".": {\n      "import": "./lib/index.js",\n      "types": "./lib/index.d.ts"\n    }\n  },\n  // \u5173\u8054yunzai\n  "keywords": ["yunzai"],\n  "publishConfig": {\n    // publish\u5730\u5740\u4e3a\u5b98\u65b9 npm\n    "registry": "https://registry.npmjs.org"\n  }\n}\n'})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"publish"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"npm publish\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u6e90\u7801",children:"\u6e90\u7801"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.a,{href:"https://github.com/yunzai-org/create-yunzai/tree/main/bin/template",children:"create-yunzai"})})]})}function p(n={}){const{wrapper:e}={...(0,l.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(o,{...n})}):o(n)}},8453:(n,e,s)=>{s.d(e,{R:()=>a,x:()=>c});var r=s(6540);const l={},i=r.createContext(l);function a(n){const e=r.useContext(i);return r.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(l):n.components||l:a(n.components),r.createElement(i.Provider,{value:e},n.children)}}}]);